# 程序化异常生成环节调研方向

**文档类型**: 技术调研
**创建日期**: 2024-12-30
**标签**: `异常生成` `调研方向` `技术路线`

---

## 调研背景

针对"程序化异常生成"（Programmatic Anomaly Generation）环节，结合当前研究与行业实践，从三个核心调研方向展开系统性构建。

---

## 核心调研方向

## 一、异常生成范式对比与融合路径 🔥

### 调研重点

#### 模板驱动 vs 生成式 AI 驱动

**两种范式对比**:

| 维度 | 模板驱动 | 生成式AI驱动 |
|------|---------|-------------|
| 可控性 | ⭐⭐⭐⭐⭐ 强 | ⭐⭐⭐ 中 |
| 泛化能力 | ⭐⭐ 弱 | ⭐⭐⭐⭐⭐ 强 |
| 多样性 | ⭐⭐ 有限 | ⭐⭐⭐⭐⭐ 丰富 |
| 语义合理性 | ⭐⭐⭐⭐ 可保障 | ⭐⭐⭐ 需验证 |
| 实施复杂度 | ⭐⭐ 低 | ⭐⭐⭐⭐ 高 |

**核心观察**:
- 模板方法可控性强但泛化能力弱
- 生成模型（如Diffusion、GAN、LLM）更具多样性，但需保障语义合理性
- 生成式AI能从学习模式中生成数据以发现异常；但需结构化模板保障任务对齐

**发展趋势**: **混合范式**（Hybrid Synthesis）正成为主流
- 用模板定义异常语义边界
- 用生成模型填充视觉/交互细节

### 建议方向

#### 1. 构建"约束-生成"两级架构 💡

**架构设计**:
```
上层：业务/交互约束层
├── 业务规则引擎
├── 状态转移约束
└── 上下文合法性验证

下层：多模态生成器
├── 图像生成（Diffusion/GAN）
├── 文本生成（LLM）
└── DOM结构生成
```

**示例**:
- 约束："支付失败只能出现在确认页之后"
- 生成：基于约束合成具体的失败界面（错误提示、按钮状态等）

#### 2. 探索 LLM + 规则引擎的协同机制

**工作流程**:
1. LLM理解当前上下文和任务意图
2. 生成候选异常场景
3. 规则引擎校验生成结果合法性
4. 不合法则迭代修正

**优势**:
- 结合LLM的语义理解能力
- 保证规则引擎的确定性约束

---

## 二、上下文感知的异常合成技术 🔥

### 调研重点

#### 上下文建模粒度

**关键问题**: 是仅基于当前界面截图，还是融合任务历史、用户意图、API状态？

**研究发现**:
- **图结构上下文表征**可有效支持异常合理性判断
- 在智能家居等领域，**上下文切片**（context slicing）被用于限定异常生成范围
- 多模态融合（视觉+交互+状态）提供更丰富的上下文信息

#### 异常注入的语义连贯性

**核心原则**: 异常必须符合状态转移逻辑

**示例**:
- ✅ **合理**: "网络错误"应出现在发起请求后
- ❌ **不合理**: "网络错误"出现在静态首页

### 建议方向

#### 1. 构建 UI 交互图谱（UI Interaction Graph）💡

**核心思路**:
- 将正常流程编码为状态转移图
- 异常仅允许在合法转移边上注入

**图谱结构**:
```
节点（Node）: UI状态
├── 截图特征
├── DOM结构
├── 可执行操作
└── 业务语义标签

边（Edge）: 状态转移
├── 触发动作
├── 前置条件
├── 可注入异常类型
└── 置信度评分
```

**应用价值**:
- 明确异常注入的合法位置
- 保证状态转移的语义一致性

#### 2. 引入领域知识图谱或操作手册结构化表示

**核心思路**:
- 将应用的操作手册、错误码文档等转化为知识图谱
- 作为异常生成的约束源

**知识图谱示例**:
```
实体：
- 操作：支付确认
- 错误：网络超时
- 状态：等待响应

关系：
- 支付确认 → 可能触发 → 网络超时
- 网络超时 → 仅出现于 → 等待响应状态
```

#### 3. 探索检索增强生成（RAG）

**工作流程**:
1. 从错误日志、用户反馈库中检索相似上下文的异常案例
2. 基于检索结果引导异常合成
3. 提高语义合理性和真实性

**数据来源**:
- 历史错误日志
- 用户反馈和崩溃报告
- 测试用例库
- 领域文档和手册

---

## 三、异常生成质量评估体系构建 🔥

### 调研重点

**当前挑战**:
- 缺乏针对UI异常生成的标准化评估指标
- 难以量化"高仿真"和"上下文相关"

**现有研究参考**:

合成数据质量评估的三个维度：
1. **保真度（Fidelity）**: 生成数据与真实数据的相似度
2. **效用性（Utility）**: 生成数据对下游任务的有用程度
3. **隐私性（Privacy）**: 是否泄露敏感信息（在异常生成中可能不适用）

异常检测领域常用指标：
- **Synthetic AUC**: 合成异常的可检测性
- **最小可检测异常**（Minimum Detectable Anomaly）: 能被检测到的最小异常程度

### 建议方向

#### 1. 设计双轨评估机制 💡

**自动化指标**:

| 指标名称 | 度量内容 | 计算方法 |
|---------|---------|---------|
| 视觉保真度 | 生成界面的真实感 | LPIPS、FID等图像质量指标 |
| 特征分布距离 | 与真实异常的相似度 | Cosine Similarity、KL散度 |
| Agent响应差异度 | 异常对Agent的影响 | 行为改变率、失败率 |
| 上下文一致性分数 | 异常在上下文中的合理性 | 基于图谱的约束满足度 |

**人工语义合理性评分**:
- 邀请测试工程师对"是否符合业务上下文"打分
- 建立评分标准和示例库
- 多人评分取平均，计算一致性

#### 2. 构建基准数据集（Benchmark）💡

**数据集构建**:

**真实异常场景收集**:
- App崩溃录屏
- 错误弹窗截图
- 用户反馈中的异常描述

**标注内容**:
- 异常类型（网络、权限、资源、逻辑等）
- 出现上下文（前置状态、触发条件）
- 严重程度（提示、警告、错误、崩溃）

**评估用途**:
- 对比生成异常与真实异常的质量
- 训练和验证生成模型
- 评估不同生成方法的优劣
---

**相关文档**:
- [方案可行性分析](./01_方案可行性分析.md)
- [技术栈与工具](../technical/技术栈与工具.md)
- [学术研究资源](../references/学术研究.md)
- [研究路线图](../planning/研究路线图.md)
